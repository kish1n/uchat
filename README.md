# UChat Project

## Описание проекта

UChat — это чат-приложение, разработанное на языке C. В проекте используется архитектура на основе сервисов и разделение на модули для работы с базой данных, аутентификации, обработки сообщений и вспомогательных пакетов.

## Структура проекта

Проект организован в несколько папок, каждая из которых отвечает за определённый аспект приложения.

### Папка `db`

В папке `db` находится код для работы с базой данных. Она разделена на два основных раздела:
- `migrations` — здесь хранятся SQL-скрипты для миграции базы данных. Файлы миграций (`001_drop.sql`, `001_init.sql`) содержат инструкции для создания и удаления таблиц.
- `core` — эта папка содержит код для работы с таблицами базы данных. Каждая таблица имеет свою поддиректорию:
    - `chat_rooms` — код для взаимодействия с таблицей чатов.
    - `messages` — код для работы с сообщениями.
    - `room_members` — код для работы с участниками комнат.
    - `users` — код для работы с пользователями.

### Папка `pkg`

Папка `pkg` содержит вспомогательные модули, которые используются в сервисах:
- `config` — модуль для загрузки конфигурации из `config.yaml`.
- `crypto` — модуль для хеширования паролей.
- `json_parser` — модуль для обработки JSON.
- `logger` — модуль для логирования.
- `worker` — модуль для управления потоками (воркерами).

Эти пакеты служат для реализации дополнительных функций, которые могут быть полезны в различных сервисах.

### Папка `services`

В этой папке хранится бизнес-логика приложения. Для каждого сервиса создаётся своя папка. В настоящее время структура включает следующие сервисы:

- `auth` — логика для аутентификации и регистрации пользователей. В этой папке также есть поддиректория `handlers`, где располагаются обработчики HTTP-запросов для регистрации и входа.
- `messenger` — логика для отправки сообщений между пользователями. В `handlers` этого сервиса будут находиться обработчики для отправки и получения сообщений.

По мере развития проекта можно добавлять новые сервисы. Например:
- `email` — для отправки подтверждений на электронную почту пользователей или других уведомлений.

### Основные файлы и настройки

- `CMakeLists.txt` — файл конфигурации для сборки проекта с помощью CMake.
- `config.yaml` — файл конфигурации, содержащий параметры базы данных, сервера, логирования и безопасности.
- `main.c` — основной файл проекта, который инициализирует сервисы, запускает воркеры и HTTP-сервер для обработки запросов.

## Как начать работу

1. **Склонируйте репозиторий** и установите необходимые зависимости (например, `libjson-c-dev`, `libpq-dev`, `libmicrohttpd-dev`).
2. **Соберите проект** с помощью CMake:
   ```bash
   mkdir build && cd build
   cmake ..
   make
   ```
3. **Запустите сервер**:
   ```bash
   ./uchat_auth
   ```
4. **Отправляйте запросы к серверу**:
    - Для регистрации: отправьте POST-запрос на `/api/v1/register` с параметрами `username` и `password`.

## Планы по улучшению

- Добавление сервиса для отправки уведомлений на электронную почту.
- Поддержка мультитрединга для обработки большого количества запросов.
- Улучшение системы логирования для удобства отладки.